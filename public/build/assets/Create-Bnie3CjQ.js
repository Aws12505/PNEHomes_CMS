import{b as ze,j as s,c as Be,u as Ke,H as Le}from"./app-FSp_WRMW.js";import{X as Fe,A as Oe}from"./app-layout-CP38ybN5.js";import{B as b}from"./app-logo-icon-C3_SM3wp.js";import{I as u}from"./input-CCpSR-nj.js";import{L as m}from"./label-VQfha4QK.js";import{S as Me}from"./switch-D8I29Vte.js";import{b as Q,C as Ge,a as Ee,c as Y}from"./card-CDLt2Map.js";import{R as Ve,a as He}from"./radio-group-fZ686Rqd.js";import{P as Te}from"./plus-D3uYX6Vx.js";import{T as qe}from"./trash-2-BFr5-KIe.js";/* empty css            */import"./index-DaUR6Y7g.js";import"./index-D2PTGCw9.js";import"./index-Cy5ipuhJ.js";async function Ue(){window.google?.accounts?.oauth2||await new Promise((e,o)=>{const l=document.createElement("script");l.src="https://accounts.google.com/gsi/client",l.async=!0,l.defer=!0,l.onload=()=>{console.debug("[GIS] loaded"),e()},l.onerror=()=>o(new Error("[GIS] failed to load")),document.head.appendChild(l)})}async function We(){window.gapi?.picker||await new Promise((e,o)=>{const l=document.createElement("script");l.src="https://apis.google.com/js/api.js",l.async=!0,l.defer=!0,l.onload=()=>{console.debug("[GAPI] api.js loaded, loading picker..."),window.gapi.load("picker",{callback:()=>{console.debug("[GAPI] picker loaded"),e()},onerror:()=>o(new Error("[GAPI] picker failed to load"))})},l.onerror=()=>o(new Error("[GAPI] api.js failed to load")),document.head.appendChild(l)})}const Re="image/*,video/*";async function Xe(e){await Promise.all([Ue(),We()]);const o=window.google;if(!o?.accounts?.oauth2)throw new Error("GIS not available");if(!window.gapi?.picker)throw new Error("Picker not available");const l=await new Promise((a,d)=>{const g=o.accounts.oauth2.initTokenClient({client_id:e.clientId,scope:"https://www.googleapis.com/auth/drive.readonly",callback:c=>{if(console.debug("[GIS] token callback",c),c?.access_token)return a(c.access_token);d(new Error(c?.error||"No access token"))},error_callback:c=>{console.error("[GIS] token error",c),d(new Error("Token error"))}});try{g.requestAccessToken({prompt:""})}catch(c){console.error("[GIS] requestAccessToken threw",c),d(c)}});return new Promise(a=>{try{new o.picker.PickerBuilder().setDeveloperKey(e.apiKey).setOAuthToken(l).setOrigin(window.location.origin).setTitle("Select or Upload (images/videos)").addView(new o.picker.DocsView(o.picker.ViewId.DOCS).setIncludeFolders(!1).setSelectFolderEnabled(!1).setMimeTypes(Re)).addView(new o.picker.DocsUploadView().setIncludeFolders(!1).setSelectFolderEnabled(!1).setMimeTypes(Re)).setCallback(g=>{if(console.debug("[Picker] callback",g),g?.action===o.picker.Action.PICKED){const c=g.docs?.[0];return a(c?{id:c.id,mimeType:c.mimeType,name:c.name}:null)}if(g?.action===o.picker.Action.CANCEL)return a(null)}).build().setVisible(!0)}catch(d){console.error("[Picker] build/open failed",d),a(null)}})}const p=({onPick:e,label:o="Pick"})=>{const{google:l}=ze().props,a=async()=>{try{const d=await Xe({apiKey:l.apiKey,clientId:l.clientId});d?.id&&e(d.id)}catch(d){console.error(d),alert("Google Drive Picker failed to open. Check API key/client ID and OAuth consent screen.")}};return s.jsx("button",{type:"button",onClick:a,className:"inline-flex items-center rounded border px-2 py-1 text-sm",children:o})},$e=[{title:"Gallery Albums",href:"/admin/gallery-albums"},{title:"Create",href:"#"}];function ds(){const e=Be.c(140);let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o={title:"",slug:"",cover_virtual_image_id:"",cover_real_image_id:"",has_sub_albums:!1,order:0,is_active:!0,sub_albums:[],images:[]},e[0]=o):o=e[0];const{data:l,setData:a,post:d,processing:g,errors:c}=Ke(o);let Z;e[1]!==d?(Z=i=>{i.preventDefault(),d("/admin/gallery-albums")},e[1]=d,e[2]=Z):Z=e[2];const Ne=Z;let ee;e[3]!==l.sub_albums||e[4]!==a?(ee=()=>{a("sub_albums",[...l.sub_albums,{slug:"",title:"",cover_virtual_image_id:"",cover_real_image_id:"",images:[]}])},e[3]=l.sub_albums,e[4]=a,e[5]=ee):ee=e[5];const ke=ee;let se;e[6]!==l.sub_albums||e[7]!==a?(se=(i,t,r)=>{const n=[...l.sub_albums];n[i][t]=r,a("sub_albums",n)},e[6]=l.sub_albums,e[7]=a,e[8]=se):se=e[8];const h=se;let le;e[9]!==l.sub_albums||e[10]!==a?(le=i=>{a("sub_albums",l.sub_albums.filter((t,r)=>r!==i))},e[9]=l.sub_albums,e[10]=a,e[11]=le):le=e[11];const we=le;let ae;e[12]!==l.sub_albums||e[13]!==a?(ae=i=>{const t=[...l.sub_albums];t[i].images.push({virtual_image_id:"",real_image_id:""}),a("sub_albums",t)},e[12]=l.sub_albums,e[13]=a,e[14]=ae):ae=e[14];const Ce=ae;let ie;e[15]!==l.sub_albums||e[16]!==a?(ie=(i,t,r,n)=>{const _=[...l.sub_albums];_[i].images[t][r]=n,a("sub_albums",_)},e[15]=l.sub_albums,e[16]=a,e[17]=ie):ie=e[17];const v=ie;let te;e[18]!==l.sub_albums||e[19]!==a?(te=(i,t)=>{const r=[...l.sub_albums];r[i].images=r[i].images.filter((n,_)=>_!==t),a("sub_albums",r)},e[18]=l.sub_albums,e[19]=a,e[20]=te):te=e[20];const Se=te;let re;e[21]!==l.images||e[22]!==a?(re=()=>{a("images",[...l.images,{virtual_image_id:"",real_image_id:""}])},e[21]=l.images,e[22]=a,e[23]=re):re=e[23];const Ie=re;let ce;e[24]!==l.images||e[25]!==a?(ce=(i,t,r)=>{const n=[...l.images];n[i][t]=r,a("images",n)},e[24]=l.images,e[25]=a,e[26]=ce):ce=e[26];const f=ce;let oe;e[27]!==l.images||e[28]!==a?(oe=i=>{a("images",l.images.filter((t,r)=>r!==i))},e[27]=l.images,e[28]=a,e[29]=oe):oe=e[29];const Pe=oe;let ne;e[30]===Symbol.for("react.memo_cache_sentinel")?(ne=s.jsx(Le,{title:"Create Gallery Album"}),e[30]=ne):ne=e[30];let me;e[31]===Symbol.for("react.memo_cache_sentinel")?(me=s.jsx("div",{className:"flex items-center justify-between",children:s.jsx("h1",{className:"text-2xl font-bold",children:"Create Gallery Album"})}),e[31]=me):me=e[31];let de;e[32]===Symbol.for("react.memo_cache_sentinel")?(de=s.jsx(Ge,{children:s.jsx(Ee,{children:"Basic Information"})}),e[32]=de):de=e[32];let ue;e[33]===Symbol.for("react.memo_cache_sentinel")?(ue=s.jsx(m,{htmlFor:"title",children:"Title *"}),e[33]=ue):ue=e[33];let x;e[34]!==a?(x=i=>a("title",i.target.value),e[34]=a,e[35]=x):x=e[35];let j;e[36]!==l.title||e[37]!==x?(j=s.jsx(u,{id:"title",value:l.title,onChange:x,placeholder:"Enter album title"}),e[36]=l.title,e[37]=x,e[38]=j):j=e[38];let y;e[39]!==c.title?(y=c.title&&s.jsx("p",{className:"text-sm text-destructive",children:c.title}),e[39]=c.title,e[40]=y):y=e[40];let N;e[41]!==j||e[42]!==y?(N=s.jsxs("div",{className:"space-y-2",children:[ue,j,y]}),e[41]=j,e[42]=y,e[43]=N):N=e[43];let _e;e[44]===Symbol.for("react.memo_cache_sentinel")?(_e=s.jsx(m,{htmlFor:"slug",children:"Slug"}),e[44]=_e):_e=e[44];let k;e[45]!==a?(k=i=>a("slug",i.target.value),e[45]=a,e[46]=k):k=e[46];let w;e[47]!==l.slug||e[48]!==k?(w=s.jsxs("div",{className:"space-y-2",children:[_e,s.jsx(u,{id:"slug",value:l.slug,onChange:k,placeholder:"auto-generated-from-title"})]}),e[47]=l.slug,e[48]=k,e[49]=w):w=e[49];let C;e[50]!==N||e[51]!==w?(C=s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[N,w]}),e[50]=N,e[51]=w,e[52]=C):C=e[52];let ge;e[53]===Symbol.for("react.memo_cache_sentinel")?(ge=s.jsx(m,{htmlFor:"cover_virtual_image_id",children:"Cover Virtual Image ID *"}),e[53]=ge):ge=e[53];let S;e[54]!==a?(S=i=>a("cover_virtual_image_id",i.target.value),e[54]=a,e[55]=S):S=e[55];let I;e[56]!==l.cover_virtual_image_id||e[57]!==S?(I=s.jsx(u,{id:"cover_virtual_image_id",value:l.cover_virtual_image_id,onChange:S,placeholder:"Google Drive file ID"}),e[56]=l.cover_virtual_image_id,e[57]=S,e[58]=I):I=e[58];let P;e[59]!==a?(P=s.jsx(p,{onPick:i=>a("cover_virtual_image_id",i),label:"Pick"}),e[59]=a,e[60]=P):P=e[60];let A;e[61]!==I||e[62]!==P?(A=s.jsxs("div",{className:"flex gap-2",children:[I,P]}),e[61]=I,e[62]=P,e[63]=A):A=e[63];let D;e[64]!==c.cover_virtual_image_id?(D=c.cover_virtual_image_id&&s.jsx("p",{className:"text-sm text-destructive",children:c.cover_virtual_image_id}),e[64]=c.cover_virtual_image_id,e[65]=D):D=e[65];let G;e[66]!==A||e[67]!==D?(G=s.jsxs("div",{className:"space-y-2",children:[ge,A,D]}),e[66]=A,e[67]=D,e[68]=G):G=e[68];let he;e[69]===Symbol.for("react.memo_cache_sentinel")?(he=s.jsx(m,{htmlFor:"cover_real_image_id",children:"Cover Real Image ID *"}),e[69]=he):he=e[69];let E;e[70]!==a?(E=i=>a("cover_real_image_id",i.target.value),e[70]=a,e[71]=E):E=e[71];let T;e[72]!==l.cover_real_image_id||e[73]!==E?(T=s.jsx(u,{id:"cover_real_image_id",value:l.cover_real_image_id,onChange:E,placeholder:"Google Drive file ID"}),e[72]=l.cover_real_image_id,e[73]=E,e[74]=T):T=e[74];let F;e[75]!==a?(F=s.jsx(p,{onPick:i=>a("cover_real_image_id",i),label:"Pick"}),e[75]=a,e[76]=F):F=e[76];let V;e[77]!==T||e[78]!==F?(V=s.jsxs("div",{className:"flex gap-2",children:[T,F]}),e[77]=T,e[78]=F,e[79]=V):V=e[79];let R;e[80]!==c.cover_real_image_id?(R=c.cover_real_image_id&&s.jsx("p",{className:"text-sm text-destructive",children:c.cover_real_image_id}),e[80]=c.cover_real_image_id,e[81]=R):R=e[81];let z;e[82]!==V||e[83]!==R?(z=s.jsxs("div",{className:"space-y-2",children:[he,V,R]}),e[82]=V,e[83]=R,e[84]=z):z=e[84];let B;e[85]!==G||e[86]!==z?(B=s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[G,z]}),e[85]=G,e[86]=z,e[87]=B):B=e[87];let be;e[88]===Symbol.for("react.memo_cache_sentinel")?(be=s.jsx(m,{children:"Album Type *"}),e[88]=be):be=e[88];const Ae=l.has_sub_albums?"sub_albums":"direct";let K;e[89]!==a?(K=i=>a("has_sub_albums",i==="sub_albums"),e[89]=a,e[90]=K):K=e[90];let pe;e[91]===Symbol.for("react.memo_cache_sentinel")?(pe=s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Ve,{value:"direct",id:"direct"}),s.jsx(m,{htmlFor:"direct",children:"Direct Images"})]}),e[91]=pe):pe=e[91];let ve;e[92]===Symbol.for("react.memo_cache_sentinel")?(ve=s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Ve,{value:"sub_albums",id:"sub_albums"}),s.jsx(m,{htmlFor:"sub_albums",children:"With Sub Albums"})]}),e[92]=ve):ve=e[92];let L;e[93]!==Ae||e[94]!==K?(L=s.jsxs("div",{className:"space-y-2",children:[be,s.jsxs(He,{value:Ae,onValueChange:K,children:[pe,ve]})]}),e[93]=Ae,e[94]=K,e[95]=L):L=e[95];let fe;e[96]===Symbol.for("react.memo_cache_sentinel")?(fe=s.jsx(m,{htmlFor:"order",children:"Order"}),e[96]=fe):fe=e[96];let O;e[97]!==a?(O=i=>a("order",parseInt(i.target.value)||0),e[97]=a,e[98]=O):O=e[98];let M;e[99]!==l.order||e[100]!==O?(M=s.jsxs("div",{className:"space-y-2",children:[fe,s.jsx(u,{id:"order",type:"number",value:l.order,onChange:O})]}),e[99]=l.order,e[100]=O,e[101]=M):M=e[101];let H;e[102]!==a?(H=i=>a("is_active",i),e[102]=a,e[103]=H):H=e[103];let q;e[104]!==l.is_active||e[105]!==H?(q=s.jsx(Me,{id:"is_active",checked:l.is_active,onCheckedChange:H}),e[104]=l.is_active,e[105]=H,e[106]=q):q=e[106];let xe;e[107]===Symbol.for("react.memo_cache_sentinel")?(xe=s.jsx(m,{htmlFor:"is_active",children:"Active"}),e[107]=xe):xe=e[107];let U;e[108]!==q?(U=s.jsxs("div",{className:"flex items-center space-x-2",children:[q,xe]}),e[108]=q,e[109]=U):U=e[109];let W;e[110]!==M||e[111]!==U?(W=s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[M,U]}),e[110]=M,e[111]=U,e[112]=W):W=e[112];let X;e[113]!==C||e[114]!==B||e[115]!==L||e[116]!==W?(X=s.jsxs(Q,{children:[de,s.jsxs(Y,{className:"space-y-4",children:[C,B,L,W]})]}),e[113]=C,e[114]=B,e[115]=L,e[116]=W,e[117]=X):X=e[117];let $;e[118]!==Ie||e[119]!==ke||e[120]!==Ce||e[121]!==l.has_sub_albums||e[122]!==l.images||e[123]!==l.sub_albums||e[124]!==Pe||e[125]!==we||e[126]!==Se||e[127]!==f||e[128]!==h||e[129]!==v?($=l.has_sub_albums?s.jsxs(Q,{children:[s.jsx(Ge,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(Ee,{children:"Sub Albums *"}),s.jsxs(b,{type:"button",onClick:ke,size:"sm",children:[s.jsx(Te,{className:"mr-2 h-4 w-4"}),"Add Sub Album"]})]})}),s.jsx(Y,{className:"space-y-4",children:l.sub_albums.length===0?s.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No sub albums added yet."}):l.sub_albums.map((i,t)=>s.jsx(Q,{children:s.jsxs(Y,{className:"pt-6 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h4",{className:"font-semibold",children:["Sub Album ",t+1]}),s.jsx(b,{type:"button",variant:"outline",size:"sm",onClick:()=>we(t),children:s.jsx(qe,{className:"h-4 w-4"})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(m,{children:"Title *"}),s.jsx(u,{value:i.title,onChange:r=>h(t,"title",r.target.value),placeholder:"Enter sub album title"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(m,{children:"Slug"}),s.jsx(u,{value:i.slug,onChange:r=>h(t,"slug",r.target.value),placeholder:"auto-generated"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(m,{children:"Cover Virtual Image ID *"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(u,{value:i.cover_virtual_image_id,onChange:r=>h(t,"cover_virtual_image_id",r.target.value),placeholder:"Google Drive ID"}),s.jsx(p,{onPick:r=>h(t,"cover_virtual_image_id",r),label:"Pick"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(m,{children:"Cover Real Image ID *"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(u,{value:i.cover_real_image_id,onChange:r=>h(t,"cover_real_image_id",r.target.value),placeholder:"Google Drive ID"}),s.jsx(p,{onPick:r=>h(t,"cover_real_image_id",r),label:"Pick"})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(m,{children:"Images"}),s.jsxs(b,{type:"button",onClick:()=>Ce(t),size:"sm",variant:"outline",children:[s.jsx(Te,{className:"mr-2 h-4 w-4"}),"Add Image"]})]}),i.images.length===0?s.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No images added"}):s.jsx("div",{className:"space-y-2",children:i.images.map((r,n)=>s.jsx(Q,{children:s.jsxs(Y,{className:"pt-4 space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{className:"text-sm font-medium",children:["Image ",n+1]}),s.jsx(b,{type:"button",variant:"ghost",size:"sm",onClick:()=>Se(t,n),children:s.jsx(Fe,{className:"h-4 w-4"})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx(u,{value:r.virtual_image_id,onChange:_=>v(t,n,"virtual_image_id",_.target.value),placeholder:"Virtual Image ID"}),s.jsx(p,{onPick:_=>v(t,n,"virtual_image_id",_),label:"Pick"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(u,{value:r.real_image_id,onChange:_=>v(t,n,"real_image_id",_.target.value),placeholder:"Real Image ID"}),s.jsx(p,{onPick:_=>v(t,n,"real_image_id",_),label:"Pick"})]})]})]})},n))})]})]})},t))})]}):s.jsxs(Q,{children:[s.jsx(Ge,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(Ee,{children:"Images *"}),s.jsxs(b,{type:"button",onClick:Ie,size:"sm",children:[s.jsx(Te,{className:"mr-2 h-4 w-4"}),"Add Image"]})]})}),s.jsx(Y,{className:"space-y-4",children:l.images.length===0?s.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No images added yet."}):l.images.map((i,t)=>s.jsx(Q,{children:s.jsxs(Y,{className:"pt-4 space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{className:"text-sm font-medium",children:["Image ",t+1]}),s.jsx(b,{type:"button",variant:"ghost",size:"sm",onClick:()=>Pe(t),children:s.jsx(Fe,{className:"h-4 w-4"})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(m,{children:"Virtual Image ID *"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(u,{value:i.virtual_image_id,onChange:r=>f(t,"virtual_image_id",r.target.value),placeholder:"Google Drive ID"}),s.jsx(p,{onPick:r=>f(t,"virtual_image_id",r),label:"Pick"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(m,{children:"Real Image ID *"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(u,{value:i.real_image_id,onChange:r=>f(t,"real_image_id",r.target.value),placeholder:"Google Drive ID"}),s.jsx(p,{onPick:r=>f(t,"real_image_id",r),label:"Pick"})]})]})]})]})},t))})]}),e[118]=Ie,e[119]=ke,e[120]=Ce,e[121]=l.has_sub_albums,e[122]=l.images,e[123]=l.sub_albums,e[124]=Pe,e[125]=we,e[126]=Se,e[127]=f,e[128]=h,e[129]=v,e[130]=$):$=e[130];let je;e[131]===Symbol.for("react.memo_cache_sentinel")?(je=s.jsx(b,{type:"button",variant:"outline",onClick:Je,children:"Cancel"}),e[131]=je):je=e[131];const De=g?"Creating...":"Create Album";let J;e[132]!==g||e[133]!==De?(J=s.jsxs("div",{className:"flex justify-end gap-2",children:[je,s.jsx(b,{type:"submit",disabled:g,children:De})]}),e[132]=g,e[133]=De,e[134]=J):J=e[134];let ye;return e[135]!==Ne||e[136]!==X||e[137]!==$||e[138]!==J?(ye=s.jsxs(Oe,{breadcrumbs:$e,children:[ne,s.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:[me,s.jsxs("form",{onSubmit:Ne,className:"space-y-6",children:[X,$,J]})]})]}),e[135]=Ne,e[136]=X,e[137]=$,e[138]=J,e[139]=ye):ye=e[139],ye}function Je(){return window.history.back()}export{ds as default};
