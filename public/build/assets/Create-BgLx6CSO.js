import{b as Re,j as s,c as ze,u as Be,H as Ke}from"./app-Dy89E0_S.js";import{X as Ve,A as Oe}from"./app-layout-8azRFZuB.js";import{B as v}from"./app-logo-icon-CoqV5uyJ.js";import{I as u}from"./input-DAeqB_0G.js";import{L as m}from"./label-DmhJY-9N.js";import{S as Le}from"./switch-BDQ0RrWn.js";import{b as Z,C as Ge,a as Ee,c as ee}from"./card-DZS5ixJn.js";import{R as Fe,a as He}from"./radio-group-DsCP7PlD.js";import{P as Te}from"./plus-BGnpzRej.js";import{T as $e}from"./trash-2-Dq_lGNUH.js";/* empty css            */import"./index-BV0r5x3t.js";import"./index-D3JiI-7_.js";import"./index-Cy5ipuhJ.js";async function Ue(){window.google?.accounts?.oauth2||await new Promise((e,c)=>{const l=document.createElement("script");l.src="https://accounts.google.com/gsi/client",l.async=!0,l.defer=!0,l.onload=()=>{console.debug("[GIS] loaded"),e()},l.onerror=()=>c(new Error("[GIS] failed to load")),document.head.appendChild(l)})}async function qe(){window.gapi?.picker||await new Promise((e,c)=>{const l=document.createElement("script");l.src="https://apis.google.com/js/api.js",l.async=!0,l.defer=!0,l.onload=()=>{console.debug("[GAPI] api.js loaded, loading picker..."),window.gapi.load("picker",{callback:()=>{console.debug("[GAPI] picker loaded"),e()},onerror:()=>c(new Error("[GAPI] picker failed to load"))})},l.onerror=()=>c(new Error("[GAPI] api.js failed to load")),document.head.appendChild(l)})}async function We(e){await Promise.all([Ue(),qe()]);const c=window.google;if(!c?.accounts?.oauth2)throw new Error("GIS not available");if(!window.gapi?.picker)throw new Error("Picker not available");const l=await new Promise((a,d)=>{c.accounts.oauth2.initTokenClient({client_id:e.clientId,scope:"https://www.googleapis.com/auth/drive.readonly",callback:o=>{if(o?.access_token)return a(o.access_token);d(new Error("No access token"))},error_callback:o=>d(o)}).requestAccessToken({prompt:""})});return new Promise(a=>{const d=new c.picker.DocsView(c.picker.ViewId.DOCS),f=new c.picker.DocsUploadView;new c.picker.PickerBuilder().setDeveloperKey(e.apiKey).setOAuthToken(l).setOrigin(`${window.location.protocol}//${window.location.host}`).setTitle("Select or Upload File").addView(d).addView(f).setCallback(g=>{if(g?.action===c.picker.Action.PICKED){const h=g.docs?.[0];return a(h?{id:h.id,mimeType:h.mimeType,name:h.name}:null)}if(g?.action===c.picker.Action.CANCEL)return a(null)}).build().setVisible(!0)})}const b=({onPick:e,label:c="Pick"})=>{const{google:l}=Re().props,a=async()=>{try{const d=await We({apiKey:l.apiKey,clientId:l.clientId});d?.id&&e(d.id)}catch(d){console.error(d),alert("Google Drive Picker failed to open. Check API key/client ID and OAuth consent screen.")}};return s.jsx("button",{type:"button",onClick:a,className:"inline-flex items-center rounded border px-2 py-1 text-sm",children:c})},Xe=[{title:"Gallery Albums",href:"/admin/gallery-albums"},{title:"Create",href:"#"}];function ms(){const e=ze.c(140);let c;e[0]===Symbol.for("react.memo_cache_sentinel")?(c={title:"",slug:"",cover_virtual_image_id:"",cover_real_image_id:"",has_sub_albums:!1,order:0,is_active:!0,sub_albums:[],images:[]},e[0]=c):c=e[0];const{data:l,setData:a,post:d,processing:f,errors:o}=Be(c);let g;e[1]!==d?(g=i=>{i.preventDefault(),d("/admin/gallery-albums")},e[1]=d,e[2]=g):g=e[2];const h=g;let se;e[3]!==l.sub_albums||e[4]!==a?(se=()=>{a("sub_albums",[...l.sub_albums,{slug:"",title:"",cover_virtual_image_id:"",cover_real_image_id:"",images:[]}])},e[3]=l.sub_albums,e[4]=a,e[5]=se):se=e[5];const we=se;let le;e[6]!==l.sub_albums||e[7]!==a?(le=(i,t,r)=>{const n=[...l.sub_albums];n[i][t]=r,a("sub_albums",n)},e[6]=l.sub_albums,e[7]=a,e[8]=le):le=e[8];const p=le;let ae;e[9]!==l.sub_albums||e[10]!==a?(ae=i=>{a("sub_albums",l.sub_albums.filter((t,r)=>r!==i))},e[9]=l.sub_albums,e[10]=a,e[11]=ae):ae=e[11];const ke=ae;let ie;e[12]!==l.sub_albums||e[13]!==a?(ie=i=>{const t=[...l.sub_albums];t[i].images.push({virtual_image_id:"",real_image_id:""}),a("sub_albums",t)},e[12]=l.sub_albums,e[13]=a,e[14]=ie):ie=e[14];const Ce=ie;let te;e[15]!==l.sub_albums||e[16]!==a?(te=(i,t,r,n)=>{const _=[...l.sub_albums];_[i].images[t][r]=n,a("sub_albums",_)},e[15]=l.sub_albums,e[16]=a,e[17]=te):te=e[17];const x=te;let re;e[18]!==l.sub_albums||e[19]!==a?(re=(i,t)=>{const r=[...l.sub_albums];r[i].images=r[i].images.filter((n,_)=>_!==t),a("sub_albums",r)},e[18]=l.sub_albums,e[19]=a,e[20]=re):re=e[20];const Se=re;let ce;e[21]!==l.images||e[22]!==a?(ce=()=>{a("images",[...l.images,{virtual_image_id:"",real_image_id:""}])},e[21]=l.images,e[22]=a,e[23]=ce):ce=e[23];const Pe=ce;let oe;e[24]!==l.images||e[25]!==a?(oe=(i,t,r)=>{const n=[...l.images];n[i][t]=r,a("images",n)},e[24]=l.images,e[25]=a,e[26]=oe):oe=e[26];const j=oe;let ne;e[27]!==l.images||e[28]!==a?(ne=i=>{a("images",l.images.filter((t,r)=>r!==i))},e[27]=l.images,e[28]=a,e[29]=ne):ne=e[29];const Ie=ne;let me;e[30]===Symbol.for("react.memo_cache_sentinel")?(me=s.jsx(Ke,{title:"Create Gallery Album"}),e[30]=me):me=e[30];let de;e[31]===Symbol.for("react.memo_cache_sentinel")?(de=s.jsx("div",{className:"flex items-center justify-between",children:s.jsx("h1",{className:"text-2xl font-bold",children:"Create Gallery Album"})}),e[31]=de):de=e[31];let ue;e[32]===Symbol.for("react.memo_cache_sentinel")?(ue=s.jsx(Ge,{children:s.jsx(Ee,{children:"Basic Information"})}),e[32]=ue):ue=e[32];let _e;e[33]===Symbol.for("react.memo_cache_sentinel")?(_e=s.jsx(m,{htmlFor:"title",children:"Title *"}),e[33]=_e):_e=e[33];let y;e[34]!==a?(y=i=>a("title",i.target.value),e[34]=a,e[35]=y):y=e[35];let N;e[36]!==l.title||e[37]!==y?(N=s.jsx(u,{id:"title",value:l.title,onChange:y,placeholder:"Enter album title"}),e[36]=l.title,e[37]=y,e[38]=N):N=e[38];let w;e[39]!==o.title?(w=o.title&&s.jsx("p",{className:"text-sm text-destructive",children:o.title}),e[39]=o.title,e[40]=w):w=e[40];let k;e[41]!==N||e[42]!==w?(k=s.jsxs("div",{className:"space-y-2",children:[_e,N,w]}),e[41]=N,e[42]=w,e[43]=k):k=e[43];let ge;e[44]===Symbol.for("react.memo_cache_sentinel")?(ge=s.jsx(m,{htmlFor:"slug",children:"Slug"}),e[44]=ge):ge=e[44];let C;e[45]!==a?(C=i=>a("slug",i.target.value),e[45]=a,e[46]=C):C=e[46];let S;e[47]!==l.slug||e[48]!==C?(S=s.jsxs("div",{className:"space-y-2",children:[ge,s.jsx(u,{id:"slug",value:l.slug,onChange:C,placeholder:"auto-generated-from-title"})]}),e[47]=l.slug,e[48]=C,e[49]=S):S=e[49];let P;e[50]!==k||e[51]!==S?(P=s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[k,S]}),e[50]=k,e[51]=S,e[52]=P):P=e[52];let he;e[53]===Symbol.for("react.memo_cache_sentinel")?(he=s.jsx(m,{htmlFor:"cover_virtual_image_id",children:"Cover Virtual Image ID *"}),e[53]=he):he=e[53];let I;e[54]!==a?(I=i=>a("cover_virtual_image_id",i.target.value),e[54]=a,e[55]=I):I=e[55];let D;e[56]!==l.cover_virtual_image_id||e[57]!==I?(D=s.jsx(u,{id:"cover_virtual_image_id",value:l.cover_virtual_image_id,onChange:I,placeholder:"Google Drive file ID"}),e[56]=l.cover_virtual_image_id,e[57]=I,e[58]=D):D=e[58];let A;e[59]!==a?(A=s.jsx(b,{onPick:i=>a("cover_virtual_image_id",i),label:"Pick"}),e[59]=a,e[60]=A):A=e[60];let G;e[61]!==D||e[62]!==A?(G=s.jsxs("div",{className:"flex gap-2",children:[D,A]}),e[61]=D,e[62]=A,e[63]=G):G=e[63];let E;e[64]!==o.cover_virtual_image_id?(E=o.cover_virtual_image_id&&s.jsx("p",{className:"text-sm text-destructive",children:o.cover_virtual_image_id}),e[64]=o.cover_virtual_image_id,e[65]=E):E=e[65];let T;e[66]!==G||e[67]!==E?(T=s.jsxs("div",{className:"space-y-2",children:[he,G,E]}),e[66]=G,e[67]=E,e[68]=T):T=e[68];let pe;e[69]===Symbol.for("react.memo_cache_sentinel")?(pe=s.jsx(m,{htmlFor:"cover_real_image_id",children:"Cover Real Image ID *"}),e[69]=pe):pe=e[69];let V;e[70]!==a?(V=i=>a("cover_real_image_id",i.target.value),e[70]=a,e[71]=V):V=e[71];let F;e[72]!==l.cover_real_image_id||e[73]!==V?(F=s.jsx(u,{id:"cover_real_image_id",value:l.cover_real_image_id,onChange:V,placeholder:"Google Drive file ID"}),e[72]=l.cover_real_image_id,e[73]=V,e[74]=F):F=e[74];let R;e[75]!==a?(R=s.jsx(b,{onPick:i=>a("cover_real_image_id",i),label:"Pick"}),e[75]=a,e[76]=R):R=e[76];let z;e[77]!==F||e[78]!==R?(z=s.jsxs("div",{className:"flex gap-2",children:[F,R]}),e[77]=F,e[78]=R,e[79]=z):z=e[79];let B;e[80]!==o.cover_real_image_id?(B=o.cover_real_image_id&&s.jsx("p",{className:"text-sm text-destructive",children:o.cover_real_image_id}),e[80]=o.cover_real_image_id,e[81]=B):B=e[81];let K;e[82]!==z||e[83]!==B?(K=s.jsxs("div",{className:"space-y-2",children:[pe,z,B]}),e[82]=z,e[83]=B,e[84]=K):K=e[84];let O;e[85]!==T||e[86]!==K?(O=s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[T,K]}),e[85]=T,e[86]=K,e[87]=O):O=e[87];let ve;e[88]===Symbol.for("react.memo_cache_sentinel")?(ve=s.jsx(m,{children:"Album Type *"}),e[88]=ve):ve=e[88];const De=l.has_sub_albums?"sub_albums":"direct";let L;e[89]!==a?(L=i=>a("has_sub_albums",i==="sub_albums"),e[89]=a,e[90]=L):L=e[90];let be;e[91]===Symbol.for("react.memo_cache_sentinel")?(be=s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Fe,{value:"direct",id:"direct"}),s.jsx(m,{htmlFor:"direct",children:"Direct Images"})]}),e[91]=be):be=e[91];let fe;e[92]===Symbol.for("react.memo_cache_sentinel")?(fe=s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Fe,{value:"sub_albums",id:"sub_albums"}),s.jsx(m,{htmlFor:"sub_albums",children:"With Sub Albums"})]}),e[92]=fe):fe=e[92];let H;e[93]!==De||e[94]!==L?(H=s.jsxs("div",{className:"space-y-2",children:[ve,s.jsxs(He,{value:De,onValueChange:L,children:[be,fe]})]}),e[93]=De,e[94]=L,e[95]=H):H=e[95];let xe;e[96]===Symbol.for("react.memo_cache_sentinel")?(xe=s.jsx(m,{htmlFor:"order",children:"Order"}),e[96]=xe):xe=e[96];let $;e[97]!==a?($=i=>a("order",parseInt(i.target.value)||0),e[97]=a,e[98]=$):$=e[98];let U;e[99]!==l.order||e[100]!==$?(U=s.jsxs("div",{className:"space-y-2",children:[xe,s.jsx(u,{id:"order",type:"number",value:l.order,onChange:$})]}),e[99]=l.order,e[100]=$,e[101]=U):U=e[101];let q;e[102]!==a?(q=i=>a("is_active",i),e[102]=a,e[103]=q):q=e[103];let W;e[104]!==l.is_active||e[105]!==q?(W=s.jsx(Le,{id:"is_active",checked:l.is_active,onCheckedChange:q}),e[104]=l.is_active,e[105]=q,e[106]=W):W=e[106];let je;e[107]===Symbol.for("react.memo_cache_sentinel")?(je=s.jsx(m,{htmlFor:"is_active",children:"Active"}),e[107]=je):je=e[107];let X;e[108]!==W?(X=s.jsxs("div",{className:"flex items-center space-x-2",children:[W,je]}),e[108]=W,e[109]=X):X=e[109];let J;e[110]!==U||e[111]!==X?(J=s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[U,X]}),e[110]=U,e[111]=X,e[112]=J):J=e[112];let M;e[113]!==P||e[114]!==O||e[115]!==H||e[116]!==J?(M=s.jsxs(Z,{children:[ue,s.jsxs(ee,{className:"space-y-4",children:[P,O,H,J]})]}),e[113]=P,e[114]=O,e[115]=H,e[116]=J,e[117]=M):M=e[117];let Q;e[118]!==Pe||e[119]!==we||e[120]!==Ce||e[121]!==l.has_sub_albums||e[122]!==l.images||e[123]!==l.sub_albums||e[124]!==Ie||e[125]!==ke||e[126]!==Se||e[127]!==j||e[128]!==p||e[129]!==x?(Q=l.has_sub_albums?s.jsxs(Z,{children:[s.jsx(Ge,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(Ee,{children:"Sub Albums *"}),s.jsxs(v,{type:"button",onClick:we,size:"sm",children:[s.jsx(Te,{className:"mr-2 h-4 w-4"}),"Add Sub Album"]})]})}),s.jsx(ee,{className:"space-y-4",children:l.sub_albums.length===0?s.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No sub albums added yet."}):l.sub_albums.map((i,t)=>s.jsx(Z,{children:s.jsxs(ee,{className:"pt-6 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h4",{className:"font-semibold",children:["Sub Album ",t+1]}),s.jsx(v,{type:"button",variant:"outline",size:"sm",onClick:()=>ke(t),children:s.jsx($e,{className:"h-4 w-4"})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(m,{children:"Title *"}),s.jsx(u,{value:i.title,onChange:r=>p(t,"title",r.target.value),placeholder:"Enter sub album title"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(m,{children:"Slug"}),s.jsx(u,{value:i.slug,onChange:r=>p(t,"slug",r.target.value),placeholder:"auto-generated"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(m,{children:"Cover Virtual Image ID *"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(u,{value:i.cover_virtual_image_id,onChange:r=>p(t,"cover_virtual_image_id",r.target.value),placeholder:"Google Drive ID"}),s.jsx(b,{onPick:r=>p(t,"cover_virtual_image_id",r),label:"Pick"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(m,{children:"Cover Real Image ID *"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(u,{value:i.cover_real_image_id,onChange:r=>p(t,"cover_real_image_id",r.target.value),placeholder:"Google Drive ID"}),s.jsx(b,{onPick:r=>p(t,"cover_real_image_id",r),label:"Pick"})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(m,{children:"Images"}),s.jsxs(v,{type:"button",onClick:()=>Ce(t),size:"sm",variant:"outline",children:[s.jsx(Te,{className:"mr-2 h-4 w-4"}),"Add Image"]})]}),i.images.length===0?s.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No images added"}):s.jsx("div",{className:"space-y-2",children:i.images.map((r,n)=>s.jsx(Z,{children:s.jsxs(ee,{className:"pt-4 space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{className:"text-sm font-medium",children:["Image ",n+1]}),s.jsx(v,{type:"button",variant:"ghost",size:"sm",onClick:()=>Se(t,n),children:s.jsx(Ve,{className:"h-4 w-4"})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx(u,{value:r.virtual_image_id,onChange:_=>x(t,n,"virtual_image_id",_.target.value),placeholder:"Virtual Image ID"}),s.jsx(b,{onPick:_=>x(t,n,"virtual_image_id",_),label:"Pick"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(u,{value:r.real_image_id,onChange:_=>x(t,n,"real_image_id",_.target.value),placeholder:"Real Image ID"}),s.jsx(b,{onPick:_=>x(t,n,"real_image_id",_),label:"Pick"})]})]})]})},n))})]})]})},t))})]}):s.jsxs(Z,{children:[s.jsx(Ge,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(Ee,{children:"Images *"}),s.jsxs(v,{type:"button",onClick:Pe,size:"sm",children:[s.jsx(Te,{className:"mr-2 h-4 w-4"}),"Add Image"]})]})}),s.jsx(ee,{className:"space-y-4",children:l.images.length===0?s.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No images added yet."}):l.images.map((i,t)=>s.jsx(Z,{children:s.jsxs(ee,{className:"pt-4 space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{className:"text-sm font-medium",children:["Image ",t+1]}),s.jsx(v,{type:"button",variant:"ghost",size:"sm",onClick:()=>Ie(t),children:s.jsx(Ve,{className:"h-4 w-4"})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(m,{children:"Virtual Image ID *"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(u,{value:i.virtual_image_id,onChange:r=>j(t,"virtual_image_id",r.target.value),placeholder:"Google Drive ID"}),s.jsx(b,{onPick:r=>j(t,"virtual_image_id",r),label:"Pick"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(m,{children:"Real Image ID *"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(u,{value:i.real_image_id,onChange:r=>j(t,"real_image_id",r.target.value),placeholder:"Google Drive ID"}),s.jsx(b,{onPick:r=>j(t,"real_image_id",r),label:"Pick"})]})]})]})]})},t))})]}),e[118]=Pe,e[119]=we,e[120]=Ce,e[121]=l.has_sub_albums,e[122]=l.images,e[123]=l.sub_albums,e[124]=Ie,e[125]=ke,e[126]=Se,e[127]=j,e[128]=p,e[129]=x,e[130]=Q):Q=e[130];let ye;e[131]===Symbol.for("react.memo_cache_sentinel")?(ye=s.jsx(v,{type:"button",variant:"outline",onClick:Je,children:"Cancel"}),e[131]=ye):ye=e[131];const Ae=f?"Creating...":"Create Album";let Y;e[132]!==f||e[133]!==Ae?(Y=s.jsxs("div",{className:"flex justify-end gap-2",children:[ye,s.jsx(v,{type:"submit",disabled:f,children:Ae})]}),e[132]=f,e[133]=Ae,e[134]=Y):Y=e[134];let Ne;return e[135]!==h||e[136]!==M||e[137]!==Q||e[138]!==Y?(Ne=s.jsxs(Oe,{breadcrumbs:Xe,children:[me,s.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:[de,s.jsxs("form",{onSubmit:h,className:"space-y-6",children:[M,Q,Y]})]})]}),e[135]=h,e[136]=M,e[137]=Q,e[138]=Y,e[139]=Ne):Ne=e[139],Ne}function Je(){return window.history.back()}export{ms as default};
